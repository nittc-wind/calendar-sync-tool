<!-- アップロード画面 -->
<div class="page-container" id="upload">
    <!-- ページタイトル -->
    <div class="page-header">
        <h1 class="page-title">Excelファイルをアップロード</h1>
        <p class="page-description">予定表のExcelファイルをアップロードしてください</p>
    </div>
    
    <!-- メインコンテンツエリア -->
    <div class="page-content">
        <!-- ここに画面固有のコンテンツを追加 -->
        
        <div class="content-section">
            <div id="drag-drop" class="drag-drop">
                <h2>ここにファイルをドラッグ＆ドロップ</h2>
                <p>もしくは</p>
            </div>
            <input type="file" id="file-select" style="display: none;">
            <button id="file-input" class="btn btn-primary">ファイルを選択</button><br><br>
            <button id="upload-button" class="btn btn-primary" style="display:none;">アップロード</button>
            <p id="upload-status"></p>
        </div>
        <script>
          document.getElementById('uploadForm').onsubmit = function(e) {
            e.preventDefault();
            const fileInput = this.file;
            if (!fileInput.files.length) return;
            const file = fileInput.files[0];
            
            // ローディング表示
            document.getElementById('loading').style.display = 'block';
            document.getElementById('result').innerText = '';
            
            const reader = new FileReader();
            reader.onload = function() {
              // DataURL形式でbase64化
              const dataUrl = reader.result;
              google.script.run
                .withSuccessHandler(function(id) {
                  document.getElementById('loading').style.display = 'none';
                  document.getElementById('result').innerHTML = 
                    'アップロード成功: <a href="https://docs.google.com/spreadsheets/d/' + id + '" target="_blank">スプレッドシートを開く</a>';
                })
                .withFailureHandler(function(err) {
                  document.getElementById('loading').style.display = 'none';
                  document.getElementById('result').innerText = 'エラー: ' + err.message;
                })
                .uploadExcelFile({ 
                  dataUrl: dataUrl, 
                  fileName: file.name, 
                  mimeType: file.type 
                });
            };
            reader.readAsDataURL(file);
          };
        </script>
    </div>
</div>